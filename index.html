<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>問題集</title>
  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --line:#e5e7eb;
      --accent:#2563eb;
      --radius:14px;
      --shadow:0 10px 30px rgba(0,0,0,.08);
      --drawer-head:54px;
    }
    *{box-sizing:border-box}
    html, body{ height:100% }
    body{
      margin:0; min-height:100dvh;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic UI", "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
      color:var(--text);
      background:linear-gradient(180deg,#fafafa, #eef2f7 60%, #e2e8f0);
      display:flex; align-items:center; justify-content:center;
      padding:18px; -webkit-font-smoothing:antialiased;
    }
    .app{
      width:min(920px,100%);
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      position:relative;
    }

    /* 透明マスク（外側クリックで閉じる用） */
    .mask{
      position:fixed; inset:0; background:transparent;
      display:none; z-index:3; touch-action:none;
    }
    .mask[data-open="true"]{ display:block }

    header{
      padding:14px 16px; border-bottom:1px solid var(--line);
      background:linear-gradient(180deg,#fff, #f9fafb);
    }
    h1{ margin:0; font-size:1.05rem; letter-spacing:.02em }

    main{ padding:14px 16px }
    .tiles{
      display:grid; gap:12px;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
    button.tile{
      appearance:none; cursor:pointer; background:#fff;
      border:1px solid var(--line); border-radius:12px;
      padding:14px; text-align:left;
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      box-shadow:0 6px 18px rgba(0,0,0,.06);
      transition:.2s transform ease, .2s box-shadow ease; width:100%;
    }
    button.tile:hover{ transform:translateY(-1px); box-shadow:0 10px 26px rgba(0,0,0,.08) }
    .tile .title{ font-weight:700; font-size:1rem }
    .chev{ margin-left:auto; opacity:.7; transition: transform .2s ease }
    .tile[aria-expanded="true"] .chev{ transform:rotate(90deg) }

    /* Drawer（PC幅でもマスクより前面に：z=4） */
    .drawer{
      margin-top:14px; border:1px solid var(--line); border-radius:12px; background:#fff;
      display:none; position:relative; z-index:4;
    }
    .drawer[aria-hidden="false"]{ display:block }
    .drawer .head{
      position:sticky; top:0; z-index:1;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:10px 10px; border-bottom:1px solid var(--line); background:#f9fafb;
      height: var(--drawer-head);
    }
    .drawer .head h2{ margin:0; font-size:.98rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
    .close{
      appearance:none; cursor:pointer; background:#fff; color:#111827; border:1px solid var(--line);
      padding:6px 8px; border-radius:10px; font-size:.88rem;
    }
    .links{ padding:12px }

    /* Drawer内：カードグリッド（カード全体がリンク） */
    .section-title{ margin:0 0 10px; font-size:.95rem; color:#374151 }
    .grid{ display:grid; gap:12px; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)) }
    .card{
      display:block; /* a要素をブロック化 */
      border:1px solid var(--line); border-radius:12px; padding:12px; background:#fff;
      box-shadow:0 4px 12px rgba(0,0,0,.06);
      text-decoration:none; color:inherit;
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
      cursor:pointer;
    }
    .card:hover{ transform:translateY(-1px); box-shadow:0 8px 18px rgba(0,0,0,.08); border-color:#d1d5db }
    .card:focus-visible{ outline:3px solid #bfdbfe; outline-offset:2px }
    .card h3{ margin:0 0 6px; font-size:1rem; line-height:1.35 }
    .card p{ margin:0; font-size:.9rem; color:var(--muted) }

    footer{
      border-top:1px solid var(--line);
      padding:10px 12px; color:#6b7280; font-size:.86rem; background:#fff;
      display:flex; justify-content:space-between; align-items:center; gap:10px;
    }

    /* Mobile bottom sheet：モバイル時は最前面へ */
    @media (max-width:600px){
      .drawer{
        position: fixed; left: 50%; transform: translateX(-50%); bottom: 0; width: min(920px, 100%);
        height: 85vh; max-height: 85vh; border-radius: 16px 16px 0 0; box-shadow: 0 16px 40px rgba(0,0,0,.18);
        z-index: 5; overflow: hidden;
      }
      .drawer .links{
        height: calc(85vh - var(--drawer-head));
        overflow-y: auto; -webkit-overflow-scrolling: touch; overscroll-behavior: contain; padding-bottom: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="mask" id="mask" aria-hidden="true"></div>
  <div class="app" aria-label="模擬試験集">
    <header><h1>模擬試験集</h1></header>
    <main>
      <div id="tiles" class="tiles"></div>
      <div id="drawers"></div>
    </main>
    <footer>
      <div>© <span id="y"></span> 模擬試験集</div><div></div>
    </footer>
  </div>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    /* ====== データ ====== */
    const data = [
      {
        label: "過去分,
        children: [
          { label: "2020年 第1回診療情報管理士模擬試験", url: "https://0213mano-png.github.io/2020_1/" },
          { label: "2020年 第2回診療情報管理士模擬試験", url: "https://0213mano-png.github.io/2020_2/" },
          { label: "2020年 第3回診療情報管理士模擬試験", url: "https://0213mano-png.github.io/2020_3/" },
          { label: "2020年 第4回診療情報管理士模擬試験", url: "https://0213mano-png.github.io/2020_4/" },
          { label: "2021年 第1回診療情報管理士模擬試験", url: "https://0213mano-png.github.io/2021_1/" },
          { label: "2021年 第2回診療情報管理士模擬試験", url: "https://0213mano-png.github.io/2021_2/" },
          { label: "2022年 第2回診療情報管理士模擬試験", url: "https://0213mano-png.github.io/2022_1/" },
          { label: "2023年 第1回診療情報管理士模擬試験", url: "https://0213mano-png.github.io/2023_2/" },
          { label: "2023年 第2回診療情報管理士模擬試験", url: "https://0213mano-png.github.io/2023_3/" },
          { label: "2023年 第3回診療情報管理士模擬試験", url: "https://0213mano-png.github.io/2023_4/" },
          { label: "2025年 第1回診療情報管理士模擬試験", url: "https://0213mano-png.github.io/2025_1/" },
          { label: "2025年 第2回診療情報管理士模擬試験", url: "https://0213mano-png.github.io/2025_2/" }
        ]
      },
      {
        label: "項目別",
        children: [
          { label: "1章 医療管理総論", url: "https://0213mano-png.github.io/1/" },
          { label: "2章 医療管理各論Ⅰ", url: "https://0213mano-png.github.io/2/" },
          { label: "3章 医療管理各論Ⅱ", url: "https://0213mano-png.github.io/3/" },
          { label: "4章 医療管理各論Ⅲ", url: "https://0213mano-png.github.io/4/" },
          { label: "5章 保健医療情報学", url: "https://0213mano-png.github.io/5/" },
          { label: "6章 医療統計Ⅰ", url: "https://0213mano-png.github.io/6/" },
          { label: "7章 医療統計Ⅱ", url: "https://0213mano-png.github.io/7/" },
          { label: "8章 診療情報管理Ⅰ", url: "https://0213mano-png.github.io/8/" },
          { label: "9章 診療情報管理Ⅱ", url: "https://0213mano-png.github.io/9/" },
          { label: "10章 診療情報管理Ⅲ", url: "https://0213mano-png.github.io/10/" },
          { label: "11章 国際統計分類Ⅰ", url: "https://0213mano-png.github.io/11/" },
          { label: "12章 国際統計分類Ⅱ", url: "https://0213mano-png.github.io/12/" }
        ]
      }
    ];

    /* ====== 要素参照 ====== */
    const tilesWrap = document.getElementById("tiles");
    const drawersWrap = document.getElementById("drawers");
    const mask = document.getElementById("mask");

    /* ====== 開閉制御 ====== */
    function closeAll(){
      for(const b of tilesWrap.querySelectorAll(".tile")) b.setAttribute("aria-expanded","false");
      for(const d of drawersWrap.querySelectorAll(".drawer")) d.setAttribute("aria-hidden","true");
      mask.dataset.open = "false"; mask.setAttribute("aria-hidden","true");
    }
    function openTarget(tile, drawer){
      closeAll();
      tile.setAttribute("aria-expanded","true");
      drawer.setAttribute("aria-hidden","false");
      mask.dataset.open = "true"; mask.setAttribute("aria-hidden","false");
      setTimeout(()=> drawer.scrollIntoView({behavior:"smooth", block:"start"}), 0);
    }
    function toggleTarget(tile, drawer){
      const isOpen = tile.getAttribute("aria-expanded") === "true";
      isOpen ? closeAll() : openTarget(tile, drawer);
    }

    /* ====== UI生成 ====== */
    function makeTile(id, title){
      const btn = document.createElement("button");
      btn.className = "tile";
      btn.id = `tile-${id}`;
      btn.setAttribute("aria-expanded","false");
      btn.setAttribute("aria-controls", `drawer-${id}`);
      btn.innerHTML = `
        <div><div class="title">${title}</div></div>
        <span class="chev" aria-hidden="true">▶</span>`;
      return btn;
    }
    function makeDrawer(id, title){
      const sec = document.createElement("section");
      sec.className = "drawer";
      sec.id = `drawer-${id}`;
      sec.setAttribute("aria-hidden","true");
      sec.innerHTML = `
        <div class="head">
          <h2>${title}</h2>
          <button class="close" type="button" data-close>閉じる</button>
        </div>
        <div class="links" id="list-${id}"></div>`;
      return sec;
    }

    // カード（childrenの1項目：カード全体が a リンク）
    function makeCardLink({label, url, desc}){
      const a = document.createElement('a');
      a.className = 'card';
      a.setAttribute('role','listitem');
      a.href = url;
      a.target = '_blank';
      a.rel = 'noopener noreferrer';
      a.innerHTML = `
        <h3>${label}</h3>
        <p>${desc || 'GitHub Pages で公開中の問題セットに移動します。'}</p>
      `;
      // 念のため：ドロワーの他イベントに伝播させない
      a.addEventListener('click', (e)=> e.stopPropagation());
      a.addEventListener('pointerdown', (e)=> e.stopPropagation());
      return a;
    }

    function renderCategory(cat, idx){
      const id = `c${idx}`;
      const tile = makeTile(id, cat.label);
      const drawer = makeDrawer(id, cat.label);
      tilesWrap.appendChild(tile);
      drawersWrap.appendChild(drawer);

      const list = drawer.querySelector(`#list-${id}`);
      const sectionTitle = document.createElement('h2');
      sectionTitle.className = 'section-title';
      sectionTitle.textContent = cat.label;

      const grid = document.createElement('div');
      grid.className = 'grid';
      grid.setAttribute('role','list');

      (cat.children || []).forEach(child => grid.appendChild(makeCardLink(child)));

      list.appendChild(sectionTitle);
      list.appendChild(grid);

      tile.addEventListener("click", () => toggleTarget(tile, drawer));
      drawer.querySelector("[data-close]").addEventListener("click", closeAll);
    }

    data.forEach((cat, i) => renderCategory(cat, i));
    mask.addEventListener("click", closeAll);
  </script>
</body>
</html>
